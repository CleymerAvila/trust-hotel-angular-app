<!-- Overlay backdrop -->
<div class="fixed inset-0 bg-black/80 bg-opacity-40 z-40 transition-opacity duration-300" (click)="closeModal()"></div>

<!-- Modal -->
<div class="fixed inset-0 z-50 flex items-center justify-center p-4">
  <div
    class="bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col transform transition-all duration-300 animate-in fade-in scale-95"
    (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="flex items-center justify-between p-6 border-b border-gray-200">
      <div>
        <h2 class="text-2xl font-bold text-gray-900">Seleccionar Cliente</h2>
        <p class="text-sm text-gray-600 mt-1">Busca y selecciona un cliente</p>
      </div>
      <button (click)="closeModal()" class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200">
        <svg class="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Search Input -->
    <div class="p-4 border-b border-gray-200">
      <div class="relative">
        <svg class="absolute left-3 top-3 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        <input type="text" [(ngModel)]="searchTerm" (input)="filterClients()" placeholder="Buscar por nombre, dni o email..."
          class="w-full pl-10 pr-4 py-2.5 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200">
      </div>
    </div>

    <!-- Clients List -->
    <div class="flex-1 overflow-y-auto">
      <div *ngIf="isLoading()" class="flex items-center justify-center h-32">
        <div class="text-center">
          <div class="animate-spin inline-block w-8 h-8 border-4 border-gray-300 border-t-blue-600 rounded-full"></div>
          <p class="mt-2 text-gray-600">Cargando clientes...</p>
        </div>
      </div>

      <div *ngFor="let client of filteredClients()" (click)="selectClient(client)"
        class="p-4 border-b border-gray-100 hover:bg-blue-50 cursor-pointer transition-colors duration-200 hover:border-blue-300">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <h3 class="font-semibold text-gray-900">{{ client.name }}</h3>
            <p class="text-sm text-gray-600 mt-1">{{ client.email }}</p>
            <p class="text-xs text-gray-500 mt-1">ID: {{ client.clientId}}</p>
          </div>
          <svg class="w-5 h-5 text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity" fill="currentColor"
            viewBox="0 0 20 20">
            <path fill-rule="evenodd"
              d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" />
          </svg>
        </div>
      </div>

      <div *ngIf="filteredClients().length === 0 && !isLoading" class="flex items-center justify-center h-32">
        <div class="text-center text-gray-500">
          <svg class="w-12 h-12 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
          </svg>
          <p class="font-medium">No se encontraron clientes</p>
          <p class="text-sm mt-1">Intenta con otro término de búsqueda</p>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="p-4 border-t border-gray-200 bg-gray-50">
      <button (click)="closeModal()"
        class="w-full px-4 py-2.5 border-2 border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-100 transition-colors duration-200">
        Cancelar
      </button>
    </div>
  </div>
</div>
